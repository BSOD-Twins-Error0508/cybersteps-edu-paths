Welcome! In our last session, we explored the fundamentals of social engineering. We learned that an attacker's primary goals are often to stealÂ **credentials**Â (like passwords) orÂ **session tokens**Â (the temporary keys that keep you logged in).

Today, we focus on the most advanced techniques attackers use to steal these assets, even when defenses like Multi-Factor Authentication (MFA) are in place. We will explore the standard defenses, see how attackers have evolved to bypass them, and then look at the solutions designed to stop them.

## The Defense: Multi-Factor Authentication (MFA)

![image (13).png](attachment:94f69364-c382-404f-9b65-d2ca1b2ae498:image_\(13\).png)

MFA is designed to prevent account takeover by requiring more than just a password. It relies on verifying a user's identity using a combination of two or more factors:

- **Something you know:**Â A password or PIN.
- **Something you have:**Â A mobile phone (for codes or pushes) or a hardware key.
- **Something you are:**Â A fingerprint or face scan.

However, as we will see, not all MFA methods are created equal. Let's examine the common types and their weaknesses.

## Common MFA Methods and Their Weaknesses

### SMS & Email Codes

![image (14).png](attachment:e7076b09-dd50-4661-bf49-0b7c25e430c0:image_\(14\).png)

This method sends a temporary code to your phone via text message or to your email. It is widely considered the weakest form of MFA.

- **How it's bypassed (SIM Swapping):**Â In aÂ SIM swapÂ attack, a social engineer convinces your mobile provider to transfer your phone number to a SIM card they control. Once they have your number, they receive your MFA codes directly and can take over your accounts without ever needing to touch your phone.
    
    ![image (15).png](attachment:e3f099fa-89d5-4ac3-b3ff-82f14a036c1f:image_\(15\).png)
    

### Push Notifications

![approve.png](attachment:82839eaa-c192-4a03-8bc8-5d2b7773d5b5:approve.png)

Instead of a code, the service sends a notification to your trusted device (usually your phone) asking you to "Approve" or "Deny" the login attempt.

- **How it's bypassed (MFA Fatigue):**Â If an attacker already has your password, they can trigger login requests over and over, spamming your phone with notifications. This is calledÂ **MFA Fatigue**Â orÂ **Push Spamming**. The attacker hopes that you will eventually get frustrated, confused, or distracted and accidentally tap "Approve."
    
    ![image (16).png](attachment:e9802d95-84d7-4af7-a47d-443e368a7e68:f5f0f82b-806a-4ae6-9d73-80fb9768802f.png)
    

### Time-based One-Time Password (TOTP)

A TOTP is the 6-digit code generated by an authenticator app (like Google Authenticator or Duo) that refreshes every 30-60 seconds. While it protects against SIM swapping, it has a different vulnerability.

![authenticators-google-one-time-password-fetch.png](attachment:d50ec339-e14f-4201-acbc-685d977d0e06:authenticators-google-one-time-password-fetch.png)

## The Ultimate Threat: Adversary-in-the-Middle (AiTM) Phishing

![image (17).png](attachment:131d1e01-b479-46a4-99c6-2a4808df2bb3:image_\(17\).png)

The most effective phishing attack today is the **Adversary-in-the-Middle (AiTM) attack**. It is the primary way attackers bypass TOTP-based MFA. Instead of just stealing your username and password with a fake login page, AiTM places an attacker-controlled server directly between you and the legitimate site.

This proxy relays everything in real time - your credentials, your MFA code, and even the resulting session cookie. The attacker then reuses that session cookie to impersonate you and perform unauthorized actions, all while you believe youâ€™ve logged in securely.

Here is the step-by-step flow:

1. **Enter Credentials**
    
    The victim enters their username and password on the phishing site (actually the AiTM proxy).
    
2. **Forward Credentials**
    
    The AiTM toolkit immediately relays these credentials to the legitimate target web server.
    
3. **Send 2FA Code**
    
    The target web server, seeing a valid login attempt, sends a 2FA code to the victim user.
    
4. **Enter 2FA Code**
    
    The victim enters the received 2FA code on the phishing site.
    
5. **Forward 2FA Code**
    
    The AiTM toolkit forwards this code to the target server to complete authentication.
    
6. **Session Cookie**
    
    The target server issues a valid authenticated session cookie back.
    
7. **Session Cookie**
    
    The AiTM toolkit provides this cookie to the victimâ€™s browser, so everything looks legitimate.
    
8. **Unauthorised Malicious Action**
    
    Meanwhile, the attacker has also stolen the same session cookie and can now perform unauthorized actions on the victimâ€™s account without needing credentials or 2FA again.
    

The key takeaway is that an AiTM attack is designed to steal the final session token, bypassing many common forms of MFA in the process.

### The Real Solution: Phishing-Resistant MFA

The only way to truly defeat AiTM phishing is with an MFA method that is cryptographically bound to the website's true domain.

**FIDO2 / WebAuthn**Â is the gold standard. This technology uses a hardware security key (like a YubiKey) or a platform authenticator built into your device (like Windows Hello or Apple's Face/Touch ID).

Hereâ€™s why it works: When you register a FIDO2 key with a service (e.g.,Â `google.com`), a unique cryptographic key pair is created that is tied to that specific domain.

If an attacker tries to phish you with an AiTM attack from a fake domain (e.g.,Â `g00gle-login.com`), your browser and the key will recognize that the domain does not match. The security key will simplyÂ **refuse to activate**. The cryptographic challenge fails, and the AiTM attack is stopped cold.

![Screenshot-2025-06-12-at-22.27.18.png](attachment:b5e9f4b1-a0c6-46fe-bf0d-161df0085590:Screenshot-2025-06-12-at-22.27.18.png)

### Try it yourself

If you use services like Google, GitHub, or Microsoft, investigate their security settings pages to see what forms of MFA they support. You don't need to enable anything now, but see what the options are and notice which ones they recommend.

<aside> ðŸ“Œ

The slides for the live session can be viewed here: [https://gamma.app/docs/Module-2-Week-3-Session-4-Advanced-Phishing-MFA-rpic4ydao33lr6e?mode=doc](https://gamma.app/docs/Module-2-Week-3-Session-4-Advanced-Phishing-MFA-rpic4ydao33lr6e?mode=doc)

Try not to peek before class - spoilers inside!

</aside>