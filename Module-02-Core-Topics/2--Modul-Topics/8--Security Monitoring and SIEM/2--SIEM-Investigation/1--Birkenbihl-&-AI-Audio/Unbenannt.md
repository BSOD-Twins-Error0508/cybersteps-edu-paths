Welcome to the world of digital investigation! In our last session, we saw how a Security Information and Event Management system collects and aggregates logs from all across an organization's network. Willkommen in der Welt der digitalen Ermittlung! In unserer letzten Sitzung haben wir gesehen, wie ein Security Information and Event Management System Protokolle aus dem gesamten Netzwerk einer Organisation sammelt und zusammenfasst.

But collecting data is only the first step. The real power of a SIEM lies in its ability to be searched, allowing us to hunt for threats, investigate incidents, and understand what's happening in our environment. Aber Daten zu sammeln ist nur der erste Schritt. Die wahre Stärke eines SIEM liegt in seiner Durchsuchbarkeit, die es uns ermöglicht, nach Bedrohungen zu suchen, Vorfälle zu untersuchen und zu verstehen, was in unserer Umgebung passiert.

This preparation will introduce you to the fundamental concepts of querying a SIEM, setting the stage for our hands-on session. Diese Vorbereitung wird Ihnen die grundlegenden Konzepte der Abfrage eines SIEM vorstellen und die Bühne für unsere praktische Sitzung bereiten.

Imagine trying to find a single, specific sentence in a library containing millions of books, none of which have a table of contents. This is what it's like to manually search through raw log files from hundreds of different systems. Stellen Sie sich vor, Sie versuchen, einen einzigen bestimmten Satz in einer Bibliothek mit Millionen von Büchern zu finden, von denen keines ein Inhaltsverzeichnis hat. Genau so ist es, wenn man manuell durch Rohdaten-Logdateien von Hunderten verschiedener Systeme sucht.

A SIEM solves this by indexing the data, making it searchable. But to search effectively, you need to speak the SIEM's language. Ein SIEM löst dieses Problem, indem es die Daten indexiert und damit durchsuchbar macht. Aber um effektiv suchen zu können, müssen Sie die Sprache des SIEM sprechen.

This language is often a specialized Search Processing Language. It's crucial to understand that different SIEM vendors use their own specific query languages. Diese Sprache ist oft eine spezialisierte Suchabfrageverarbeitungssprache. Es ist wichtig zu verstehen, dass verschiedene SIEM-Anbieter ihre eigenen spezifischen Abfragesprachen verwenden.

For example, Splunk uses SPL, Microsoft Sentinel uses Kusto Query Language, and other platforms might use a syntax that feels more like SQL. Zum Beispiel verwendet Splunk SPL, Microsoft Sentinel verwendet die Kusto Query Language und andere Plattformen verwenden möglicherweise eine Syntax, die sich eher wie SQL anfühlt.

While we will focus on SPL in our class because its concepts are highly influential, the most important takeaway is this: the language syntax may change, but the investigative methodology and the logical approach to querying data do not. Obwohl wir uns in unserem Kurs auf SPL konzentrieren werden, da seine Konzepte sehr einflussreich sind, ist das Wichtigste, was man mitnehmen sollte, Folgendes: Die Sprachsyntax mag sich ändern, aber die Ermittlungsmethodik und der logische Ansatz für die Datenabfrage nicht.

Learning how to form a hypothesis, start broad, pivot on key findings, and build a story are universal skills. Mastering them will allow you to be effective on any SIEM platform you encounter in your career. Zu lernen, wie man eine Hypothese aufstellt, breit anfängt, auf Schlüsselergebnisse umschwenkt und eine Geschichte aufbaut, sind universelle Fähigkeiten. Wenn Sie diese meistern, können Sie auf jeder SIEM-Plattform, der Sie in Ihrer Karriere begegnen, effektiv arbeiten.

At its heart, a query is simply a question you ask your data. These questions are constructed from a few key components that work together to filter, transform, and display results. Im Kern ist eine Abfrage einfach eine Frage, die Sie an Ihre Daten stellen. Diese Fragen setzen sich aus einigen Schlüsselkomponenten zusammen, die zusammenarbeiten, um Ergebnisse zu filtern, zu transformieren und anzuzeigen.

When a SIEM ingests a log entry, it intelligently extracts key pieces of information, turning them into fields. A field is a key-value pair that provides context. The fields available to you depend entirely on the log source. Wenn ein SIEM einen Protokolleintrag aufnimmt, extrahiert es intelligent die wichtigsten Informationen und wandelt sie in Felder um. Ein Feld ist ein Schlüssel-Wert-Paar, das Kontext liefert. Die Ihnen zur Verfügung stehenden Felder hängen vollständig von der Protokollquelle ab.

Fields are the nouns of our search language. Identifying the right fields is the first step in any successful query. Felder sind die Substantive unserer Suchsprache. Die Identifizierung der richtigen Felder ist der erste Schritt bei jeder erfolgreichen Abfrage.

Operators allow us to create logical statements to filter our data. Operatoren ermöglichen es uns, logische Anweisungen zu erstellen, um unsere Daten zu filtern.

Commands are the verbs of our search language. They tell the SIEM what to do with the data it finds. You chain commands together with a pipe character, sending the output of one command to be the input of the next. This creates a powerful data processing pipeline. Befehle sind die Verben unserer Suchsprache. Sie sagen dem SIEM, was es mit den gefundenen Daten tun soll. Sie verketten Befehle mit einem Pipe-Zeichen, wobei die Ausgabe eines Befehls als Eingabe für den nächsten dient. Dies schafft eine leistungsfähige Datenverarbeitungs-Pipeline.

Knowing the commands is one thing; knowing how to approach a problem is another. Security investigations aren't just about typing random queries. They follow a structured process that helps you stay organized, efficient, and avoid getting lost in the data. Die Befehle zu kennen ist eine Sache; zu wissen, wie man an ein Problem herangeht, ist eine andere. Bei Sicherheitsuntersuchungen geht es nicht nur darum, willkürliche Abfragen einzugeben. Sie folgen einem strukturierten Prozess, der Ihnen hilft, organisiert und effizient zu bleiben und sich nicht in den Daten zu verlieren.

Every investigation starts with a question or a theory. This is your initial guide. Jede Untersuchung beginnt mit einer Frage oder einer Theorie. Dies ist Ihr erster Leitfaden.

Don't try to write the perfect, ultra-specific query on your first try. Start with a wide lens to understand the landscape, then zoom in. Versuchen Sie nicht, beim ersten Versuch die perfekte, ultraspezifische Abfrage zu schreiben. Beginnen Sie mit einem Weitwinkelobjektiv, um die Landschaft zu verstehen, und zoomen Sie dann hinein.

Once your initial query yields a significant finding - an Indicator of Compromise like a suspicious IP address - that piece of information becomes a pivot point. You use it to ask new questions across all your data sources. Sobald Ihre erste Abfrage einen signifikanten Fund ergibt - einen Indikator für eine Kompromittierung wie eine verdächtige IP-Adresse - wird dieses Informationsstück zu einem Angelpunkt. Sie nutzen es, um neue Fragen über all Ihre Datenquellen hinweg zu stellen.

The ultimate goal is to reconstruct the sequence of events using the timestamp field as your guide. Your queries should help you build a precise, evidence-backed narrative. Das ultimative Ziel ist es, die Abfolge der Ereignisse mit Hilfe des Zeitstempelfeldes als Leitfaden zu rekonstruieren. Ihre Abfragen sollten Ihnen helfen, eine präzise, durch Beweise gestützte Erzählung aufzubauen.

You receive an alert that a user account, svc_database, which is a non-interactive service account, has just had a successful interactive login from a workstation in the marketing department. Normally, this account should only ever log in non-interactively from a specific database server. Sie erhalten eine Warnung, dass ein Benutzerkonto namens svc_database, bei dem es sich um ein nicht-interaktives Dienstkonto handelt, gerade eine erfolgreiche interaktive Anmeldung von einer Workstation in der Marketingabteilung hatte. Normalerweise sollte sich dieses Konto nur nicht-interaktiv von einem bestimmten Datenbankserver aus anmelden.

Following the investigation methodology, what is your initial hypothesis? What would be your first, broad query? And what piece of information would you immediately try to pivot on? Wenn Sie der Untersuchungsmethodik folgen, was ist Ihre erste Hypothese? Was wäre Ihre erste, breit gefasste Abfrage? Und auf welche Information würden Sie sofort versuchen, den Dreh- und Angelpunkt zu legen?