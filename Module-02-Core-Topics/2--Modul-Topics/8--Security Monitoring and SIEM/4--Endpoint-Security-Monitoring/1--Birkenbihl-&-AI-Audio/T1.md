Welcome to the world of endpoint security! So far, we've spent a lot of time looking at what happens on the network. Willkommen in der Welt der Endpunktsicherheit! Bisher haben wir viel Zeit damit verbracht, uns anzusehen, was im Netzwerk passiert.

But what happens when an attacker gets past our network defenses? Aber was passiert, wenn ein Angreifer an unseren Netzwerkverteidigungen vorbeikommt?

The real battle often takes place on the endpoints themselves, the laptops, servers, and other devices that are the ultimate targets. Der eigentliche Kampf findet oft auf den Endpunkten selbst statt, den Laptops, Servern und anderen Geräten, die die ultimativen Ziele sind.

This lesson is about how we gain visibility into what's happening on these devices to detect and respond to threats. Diese Lektion handelt davon, wie wir Einblick in das gewinnen, was auf diesen Geräten passiert, um Bedrohungen zu erkennen und darauf zu reagieren.

What is an Endpoint? Was ist ein Endpunkt?

In cybersecurity, an endpoint is any device that is connected to the computer network. In der Cybersicherheit ist ein Endpunkt jedes Gerät, das mit dem Computernetzwerk verbunden ist.

This is a broad term that includes user devices such as laptops, desktop computers, smartphones, and tablets. Dies ist ein weiter Begriff, der Benutzergeräte wie Laptops, Desktop-Computer, Smartphones und Tablets umfasst.

It also includes servers, both physical and virtual servers that host applications and data. Es umfasst auch Server, sowohl physische als auch virtuelle Server, die Anwendungen und Daten hosten.

And it includes Internet of Things devices like smart TVs, printers, security cameras, and other smart devices. Und es umfasst Internet-of-Things-Geräte wie Smart-TVs, Drucker, Überwachungskameras und andere intelligente Geräte.

Essentially, if it's a computing device at the end of a network connection, it's an endpoint. Im Wesentlichen ist es ein Endpunkt, wenn es ein Computergerät am Ende einer Netzwerkverbindung ist.

For attackers, endpoints are the prize. It's where they can steal data, install malware, or launch further attacks into the network. Für Angreifer sind Endpunkte der Preis. Dort können sie Daten stehlen, Malware installieren oder weitere Angriffe ins Netzwerk starten.

The Problem, Why Aren't Default Logs Enough? Das Problem, warum sind Standard-Logs nicht ausreichend?

Every Windows system generates logs. You can open the Event Viewer right now and see a stream of information about system, security, and application events. Jedes Windows-System generiert Logs. Sie können den Event Viewer jetzt öffnen und einen Strom von Informationen über System-, Sicherheits- und Anwendungsereignisse sehen.

So why do we need special tools? Also warum brauchen wir spezielle Werkzeuge?

The reality is that for security purposes, the default logs are often insufficient. Die Realität ist, dass für Sicherheitszwecke die Standard-Logs oft unzureichend sind.

They were designed primarily for system troubleshooting, not for detailed threat hunting. Sie wurden hauptsächlich für System-Fehlerbehebung entwickelt, nicht für detaillierte Bedrohungsjagd.

Here are some of their key limitations. Hier sind einige ihrer Haupteinschränkungen.

No Command Line Logging. By default, if an attacker runs powershell dot exe with an encoded command, the standard logs will show that powershell dot exe was run, but they won't record the malicious encoded command that followed. Keine Befehlszeilen-Protokollierung. Standardmäßig zeigen die Standard-Logs, dass powershell Punkt exe ausgeführt wurde, wenn ein Angreifer powershell Punkt exe mit einem codierten Befehl ausführt, aber sie zeichnen den bösartigen codierten Befehl, der folgte, nicht auf.

This context is critical. Dieser Kontext ist kritisch.

No Process Context for Network Connections. The Security log might show a network connection was made, but it won't tell you which process made it. Kein Prozesskontext für Netzwerkverbindungen. Das Sicherheitslog zeigt möglicherweise, dass eine Netzwerkverbindung hergestellt wurde, aber es sagt Ihnen nicht, welcher Prozess sie erstellt hat.

Was it your web browser, or was it a piece of malware hiding as svchost dot exe? War es Ihr Webbrowser, oder war es ein Stück Malware, das sich als svchost Punkt exe tarnte?

No File Hashing. When a new executable appears on the system, the default logs don't automatically record its file hash, for example SHA two fifty six. Kein Datei-Hashing. Wenn eine neue ausführbare Datei im System erscheint, zeichnen die Standard-Logs ihren Datei-Hash nicht automatisch auf, zum Beispiel SHA zweihundertsechsundfünfzig.

Hashing is essential for identifying known malware. Hashing ist wesentlich zur Identifizierung bekannter Malware.

Too Much Noise. Default logs are incredibly noisy, filled with routine operational data. Zu viel Rauschen. Standard-Logs sind unglaublich laut, gefüllt mit routinemäßigen Betriebsdaten.

Finding a real threat is like finding a needle in a haystack of irrelevant information. Eine echte Bedrohung zu finden ist wie eine Nadel im Heuhaufen irrelevanter Informationen zu finden.

To overcome these limitations, we need specialized tools that are purpose built to generate high quality, security relevant data. Um diese Einschränkungen zu überwinden, brauchen wir spezialisierte Werkzeuge, die zweckgebaut sind, um qualitativ hochwertige, sicherheitsrelevante Daten zu generieren.

The Solution, Specialized Endpoint Monitoring Tools. Die Lösung, spezialisierte Endpunkt-Überwachungswerkzeuge.

To get the visibility we need, we rely on a set of tools that augment or replace default logging. Um die Sichtbarkeit zu erhalten, die wir brauchen, verlassen wir uns auf eine Reihe von Werkzeugen, die die Standard-Protokollierung ergänzen oder ersetzen.

They provide the rich, contextual data required for modern Endpoint Detection and Response. Sie liefern die reichhaltigen, kontextuellen Daten, die für moderne Endpunkterkennung und -reaktion erforderlich sind.

Let's explore three of the most important open source tools in this space. Lassen Sie uns drei der wichtigsten Open-Source-Werkzeuge in diesem Bereich erkunden.

Sysmon, The Ultimate Data Source. Sysmon, die ultimative Datenquelle.

Sysmon, or System Monitor, is a free tool from Microsoft's Sysinternals suite. Sysmon oder System Monitor ist ein kostenloses Werkzeug aus Microsofts Sysinternals-Suite.

Its purpose is simple but powerful, to generate high fidelity logs about security relevant events on a Windows system. Sein Zweck ist einfach, aber mächtig, hochwertige Logs über sicherheitsrelevante Ereignisse auf einem Windows-System zu generieren.

It installs as a system service and writes its data to the Windows Event Log, creating a new log channel that is packed with useful information. Es installiert sich als Systemdienst und schreibt seine Daten ins Windows Event Log, wodurch ein neuer Log-Kanal erstellt wird, der mit nützlichen Informationen vollgepackt ist.

Unlike default logs, Sysmon is designed for security. Anders als Standard-Logs ist Sysmon für Sicherheit konzipiert.

It captures the exact data that analysts need, including Event ID one, Process Creation. Es erfasst die exakten Daten, die Analysten benötigen, einschließlich Event ID eins, Prozesserstellung.

This logs every time a process starts, including its hash, the full command line, and its parent process. Dies protokolliert jedes Mal, wenn ein Prozess startet, einschließlich seines Hashs, der vollständigen Befehlszeile und seines Elternprozesses.

This is the gold standard for process monitoring. Dies ist der Goldstandard für Prozessüberwachung.

Event ID three, Network Connection, logs all TCP slash UDP connections and, crucially, ties each connection to the specific process that initiated it. Event ID drei, Netzwerkverbindung, protokolliert alle TCP-Schrägstrich-UDP-Verbindungen und verknüpft entscheidend jede Verbindung mit dem spezifischen Prozess, der sie initiiert hat.

Event ID eleven, File Creation, logs when files are created, which is useful for tracking malware droppers. Event ID elf, Dateierstellung, protokolliert, wenn Dateien erstellt werden, was nützlich ist zum Verfolgen von Malware-Droppern.

Event ID twenty two, DNS Query, logs DNS queries made by processes, revealing which domains they are trying to contact for Command and Control. Event ID zweiundzwanzig, DNS-Abfrage, protokolliert DNS-Abfragen von Prozessen und enthüllt, welche Domains sie für Command and Control zu kontaktieren versuchen.

Sysmon is not a security tool on its own, it is a data source. Sysmon ist für sich allein kein Sicherheitswerkzeug, es ist eine Datenquelle.

Its job is to produce the raw data. This data is then typically forwarded to a SIEM for analysis and alerting. Seine Aufgabe ist es, die Rohdaten zu produzieren. Diese Daten werden dann typischerweise an ein SIEM zur Analyse und Alarmierung weitergeleitet.

Wazuh, The Open Source Security Platform. Wazuh, die Open-Source-Sicherheitsplattform.

Wazuh is a comprehensive, open source security platform that combines the capabilities of a Host based Intrusion Detection System, EDR, and SIEM. Wazuh ist eine umfassende Open-Source-Sicherheitsplattform, die die Fähigkeiten eines hostbasierten Intrusion-Detection-Systems, EDR und SIEM kombiniert.

It operates on a manager agent model. Es arbeitet nach einem Manager-Agent-Modell.

Wazuh Agent is a small program you install on your endpoints, Windows, macOS, or Linux. Wazuh Agent ist ein kleines Programm, das Sie auf Ihren Endpunkten installieren, Windows, macOS oder Linux.

It collects system data, such as logs, including Sysmon logs, file changes, and running processes. Es sammelt Systemdaten wie Logs, einschließlich Sysmon-Logs, Dateiänderungen und laufende Prozesse.

Wazuh Manager is a central server that collects and analyzes the data from all its registered agents. Wazuh Manager ist ein zentraler Server, der die Daten von allen seinen registrierten Agents sammelt und analysiert.

It uses a powerful ruleset to correlate events, detect known attack patterns, and generate alerts. Es verwendet ein mächtiges Regelwerk, um Ereignisse zu korrelieren, bekannte Angriffsmuster zu erkennen und Alarme zu generieren.

Wazuh Indexer and Dashboard. The manager stores all data and alerts in the Wazuh indexer and provides a web interface, Wazuh dashboard, for searching data and visualizing alerts. Wazuh Indexer und Dashboard. Der Manager speichert alle Daten und Alarme im Wazuh-Indexer und bietet eine Weboberfläche, Wazuh-Dashboard, zum Durchsuchen von Daten und Visualisieren von Alarmen.

Wazuh's key strengths are its analytical capabilities and breadth of features, including File Integrity Monitoring, vulnerability detection, and security configuration assessment. Wazuhs Hauptstärken sind seine analytischen Fähigkeiten und die Breite der Funktionen, einschließlich Dateiintegritätsüberwachung, Schwachstellenerkennung und Sicherheitskonfigurationsbewertung.

It takes raw data, like from Sysmon, and turns it into actionable security alerts. Es nimmt Rohdaten, wie von Sysmon, und verwandelt sie in umsetzbare Sicherheitsalarme.

osquery, The Endpoint as a Database. osquery, der Endpunkt als Datenbank.

