## 1. Schwachstellen & Scanning

### Was sind Schwachstellen?

Eine **Schwachstelle** ist eine Sicherheitsl√ºcke in einem System, die ausgenutzt werden kann. Denk an ein schwaches T√ºrschloss ‚Äì die T√ºr soll sch√ºtzen, aber das kaputte Schloss macht sie nutzlos.

**H√§ufige Ursachen:**

- **Programmierfehler** ‚Äì Bugs im Code
- **Fehlkonfigurationen** ‚Äì z.B. Standard-Passw√∂rter nicht ge√§ndert
- **Veraltete Software** ‚Äì fehlende Sicherheitsupdates
- **Design-Fehler** ‚Äì grunds√§tzlich unsichere Architektur

### CVE ‚Äì Die universelle Sprache

**CVE** (Common Vulnerabilities and Exposures) ist ein eindeutiger Name f√ºr jede bekannte Schwachstelle.

Format: `CVE-2017-5638`

- CVE = Standard-Pr√§fix
- 2017 = Jahr der Entdeckung
- 5638 = eindeutige Nummer

**Warum wichtig?** Alle weltweit k√∂nnen √ºber dieselbe Schwachstelle sprechen, ohne Verwirrung.

### CVSS ‚Äì Gefahren-Bewertung

**CVSS** (Common Vulnerability Scoring System) bewertet Schwachstellen mit Punkten von 0.0 bis 10.0.

- **9.0-10.0** = KRITISCH ‚Üí sofort handeln!
- **7.0-8.9** = hoch
- **4.0-6.9** = mittel
- **0.1-3.9** = niedrig

**Bewertungsfaktoren:**

- Wie leicht ist die Ausnutzung?
- Welche Zugriffsrechte werden ben√∂tigt?
- Welche Auswirkungen hat es auf Vertraulichkeit, Integrit√§t und Verf√ºgbarkeit?

### Vulnerability Scanning

**Automatisches Aufsp√ºren** von Sicherheitsl√ºcken in Systemen und Netzwerken.

**Ablauf:**

1. Identifiziere laufende Systeme und Dienste
2. Pr√ºfe auf bekannte Schwachstellen
3. Vergleiche mit CVE-Datenbank
4. Erstelle Bericht mit CVSS-Bewertung

**Zwei Scan-Typen:**

**Unauthenticated Scan** (ohne Login)

- Sicht eines externen Angreifers
- Findet: offene Ports, anf√§llige Dienste
- Wie: Jemand schaut dein Haus von au√üen an

**Authenticated Scan** (mit Login-Daten)

- Detaillierte Insider-Sicht
- Findet: fehlende Patches, schwache Konfigurationen
- Wie: Inspektor durchsucht jedes Zimmer

**Wichtigste Tools:**

- **Nessus** ‚Äì Marktf√ºhrer, einfach zu bedienen
- **OpenVAS** ‚Äì kostenlos, open-source

---

## 2. Metasploit Framework

### Was ist Metasploit?

Die **Schweizer Taschenmesser-Toolbox** f√ºr Penetration Testing. Eine riesige Bibliothek von Exploits, um Schwachstellen auszunutzen.

**Hauptfunktionen:**

1. Exploit finden
2. Konfigurieren f√ºr Ziel-System
3. Payload (Schadcode) ausliefern
4. Zugriff erlangen

### Wichtige Begriffe

**Exploit** ‚Äì Code, der eine Schwachstelle ausnutzt

**Payload** ‚Äì Was nach erfolgreichem Exploit ausgef√ºhrt wird (z.B. Shell √∂ffnen)

**Listener** ‚Äì Wartet auf eingehende Verbindung vom Ziel

**Module-Typen:**

- **Exploit** ‚Äì Nutzt Schwachstellen aus
- **Auxiliary** ‚Äì Scannen, Reconnaissance (ohne Exploit)
- **Post-Exploitation** ‚Äì Nach erfolgreichem Zugriff (Rechte erweitern, Daten sammeln)

### Payload-Typen

**Staged (mehrstufig)**

- Kleiner "Stager" zuerst ‚Üí l√§dt Rest nach
- ‚úÖ Kleiner, unauff√§lliger
- ‚ùå Zwei Verbindungen n√∂tig

**Stageless (einstufig)**

- Alles in einem Paket
- ‚úÖ Eine Verbindung, einfacher
- ‚ùå Gr√∂√üer, kann auffallen

### Die zwei wichtigsten Tools

**msfconsole** ‚Äì Hauptinterface (hier arbeitest du)

**msfvenom** ‚Äì Erstellt Payload-Dateien (z.B. f√ºr Phishing)

### Typischer Workflow

```
1. search eternalblue          # Exploit suchen
2. use exploit/...              # Exploit ausw√§hlen
3. show options                 # Parameter anzeigen
4. set RHOSTS 192.168.1.10     # Ziel-IP setzen
5. set LHOST 192.168.1.5       # Deine IP setzen
6. exploit                      # Angriff starten
```

**Wichtigste Optionen:**

- `RHOSTS` = Ziel-IP(s)
- `LHOST` = Deine IP (f√ºr R√ºckverbindung)

---

## 3. Boot2Root ‚Äì Von Null zu Administrator

### Der Angriffspfad (3 Schritte)

```
1. Foothold (Ersteinbruch)
   ‚Üì
2. Privilege Escalation (Rechte erweitern)
   ‚Üì
3. Ziel erreichen (z.B. Daten stehlen)
```

### 1. Foothold: SSH-Schl√ºssel stehlen

**SSH-Schl√ºssel = Passwort-Ersatz**

- **Public Key** (`id_rsa.pub`) ‚Äì Das Schloss (auf Server)
- **Private Key** (`id_rsa`) ‚Äì Der Schl√ºssel (auf deinem PC)

**Angriff:** Private Key stehlen = sofortiger Zugang zu allen vertrauten Servern!

### 2. Privilege Escalation: SUID + PATH Hijacking

**SUID-Berechtigung**

- Programm l√§uft mit Rechten des Besitzers (nicht des Ausf√ºhrenden)
- Wenn Besitzer = `root` ‚Üí Programm hat root-Rechte!
- **GTFOBins.github.io** ‚Äì Liste missbrauchbarer SUID-Programme

**PATH Variable**

- Liste von Verzeichnissen, wo System nach Befehlen sucht
- Sucht von links nach rechts

**PATH Hijacking:**

1. SUID-Programm ruft Befehl ohne vollen Pfad auf (z.B. `ls`)
2. Erstelle b√∂sartiges Skript namens `ls`
3. F√ºge dein Verzeichnis vorne in PATH ein
4. SUID-Programm f√ºhrt DEIN `ls` mit root-Rechten aus!

### 3. Ziel: /etc/shadow lesen

**Die Kronjuwelen:** `/etc/shadow` ‚Äì enth√§lt gehashte Passw√∂rter aller Nutzer

Nur `root` kann diese Datei lesen!

**Format:**

```
jdoe:$6$salt$hash...:18301:0:99999:7:::
     ‚Üë
     SHA-512 Hash
```

**Was dann?** Mit Tools wie **John the Ripper** oder **Hashcat** Passw√∂rter knacken.

---

## 4. H√§ufige Software-Schwachstellen

### Buffer Overflow

**Das Problem:** Programm schreibt mehr Daten in Speicher, als Platz ist.

**Metapher:** 10 Leute f√ºr 5 Sitzpl√§tze ‚Äì die restlichen 5 setzen sich einfach auf die Nachbarpl√§tze (√ºberschreiben wichtige Daten).

**Anf√§lliger C-Code:**

```c
char buffer[100];
strcpy(buffer, user_input);  // GEF√ÑHRLICH! Keine L√§ngenpr√ºfung
```

**Angriff:**

1. Sende 200 Bytes Input f√ºr 100-Byte-Buffer
2. √úberschreibe benachbarte Speicherbereiche
3. M√∂gliche Folgen:
    - Programm-Absturz
    - Variable √§ndern (`is_admin = True`)
    - Code-Ausf√ºhrung (shellcode)

**Warum nicht in Python?**

- Automatische Speicherverwaltung
- Bounds Checking (IndexError)
- Keine direkten Pointer

### Command Injection

**Das Problem:** User-Input wird in System-Befehle eingef√ºgt, ohne √úberpr√ºfung.

**Anf√§lliger Python-Code:**

```python
domain = user_input
os.system(f"ping -c 4 {domain}")  # GEF√ÑHRLICH!
```

**Angriff:** Input: `google.com; whoami`

Ausgef√ºhrt: `ping -c 4 google.com; whoami`

Shell f√ºhrt BEIDE Befehle aus!

**Gef√§hrliche Shell-Zeichen:**

- `;` ‚Äì N√§chster Befehl (immer)
- `&&` ‚Äì N√§chster Befehl (wenn erster erfolgreich)
- `|` ‚Äì Pipe (Output ‚Üí Input)

**Noch gef√§hrlicher:** `8.8.8.8; cat /etc/passwd` ‚Äì Sensible Dateien lesen `8.8.8.8; rm -rf /` ‚Äì System zerst√∂ren

### Race Condition (TOCTOU)

**Das Problem:** Zwischen Pr√ºfung und Nutzung √§ndert sich der Zustand.

**TOCTOU = Time-of-Check to Time-of-Use**

**Szenario:**

1. **Time of Check:** Programm pr√ºft: "Ist `/home/user/log.txt` sicher?"
2. **Race Window:** Angreifer tauscht Datei gegen Symlink zu `/etc/shadow`
3. **Time of Use:** Programm schreibt in (vermeintliche) log.txt ‚Üí √ºberschreibt `/etc/shadow`!

**Das Rennen:** Angreifer muss Datei im winzigen Zeitfenster austauschen.

**Beispiel-Auswirkung:**

- `/etc/shadow` √ºberschrieben
- Alle User ausgesperrt
- Oder: Angreifer erh√§lt Zugang

---

## Schnell-Referenz

### CVE & CVSS

- CVE = eindeutiger Name
- CVSS = Gefahren-Score (0-10)
- 9+ = KRITISCH

### Metasploit Basics

```
search <keyword>
use <exploit>
show options
set RHOSTS <target-ip>
set LHOST <your-ip>
exploit
```

### Boot2Root Pfad

1. SSH-Key stehlen (Foothold)
2. SUID + PATH (Privilege Escalation)
3. /etc/shadow lesen (Ziel)

### Top 3 Schwachstellen

1. **Buffer Overflow** ‚Äì Zu viel Input
2. **Command Injection** ‚Äì Unsaubere Shell-Befehle
3. **Race Condition** ‚Äì Timing-Problem

---

**Tipp zum Lernen:** Lies jedes Kapitel einzeln durch und versuche, die Konzepte in eigenen Worten zu erkl√§ren. Wenn du es jemandem erkl√§ren kannst, hast du es verstanden!

**Erfolg!** üéØ